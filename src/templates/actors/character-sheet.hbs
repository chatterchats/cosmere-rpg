<form class="sheet actor character" autocomplete="off">
    {{log actor}}
    <header class="sheet-header flexrow">
        <section class="flexrow">
            <section class="header-details flexcol">
                <section class="flex-group-left">
                    COSMERE <br />
                    ROLEPLAYING GAME<br />
                </section>
                <section>
                    <input name="system.character.player" value="" placeholder="Player Name(WIP)" />
                </section>
            </section>
            <section class="header-details flexcol grid-span2">
                <h1 class="document-name flexcol">
                    <section class="flexrow">
                        <span>
                            <input class="document-name value" name="name" value="{{actor.name}}" />
                        </span>
                        <span>
                           <input class="value" name="system.level" value="{{level}}" placeholder="Level(WIP)" /> 
                        </span>
                    </section>
                    <section class="flexrow">
                        <span class="ancestry">
                            <input class="value"  name="system.character.ancestry" value="{{ localize ancestryLabel }}" placeholder="Ancestry (WIP)" />
                        </span>
                        <span class="paths">
                            <input class="value" name="system.character.paths" value="{{ localize pathsLabel }}" placeholder="Ancestry (WIP)" />
                        </span>
                    </section>
                    
                </h1>
            </section>
        </section>
    </header>

    <hr />
    <section class="attribute-groups flexrow">
        {{#each attributeGroups as |attrGroup|}}
            <section class="attribute-group" data-id="{{attrGroup.id}}">
                {{!-- Header --}}
                <span class="label">
                    {{ localize attrGroup.config.label }}
                </span>

                {{!-- Attributes and defense --}}
                <section class="attributes flexrow">
                    {{#with attrGroup.attributes.[0] as |attribute|}}
                        <div class="attribute flexcol" data-id="{{attribute.id}}">
                            <span class="box-title">
                                {{ localize attribute.config.label }}
                            </span>
                            <span class="value">
                                <input 
                                    class="value" 
                                    size="2" 
                                    name="system.attributes.{{attribute.config.key}}.value" 
                                    value="{{attribute.value}}" 
                                />
                            </span>
                        </div>
                    {{/with}}

                    {{#with attrGroup.defense as |defense|}}
                        <div class="defense">
                            <span class="box-title">{{ localize "COSMERE.Actor.Statistics.Defense"}}</span>
                            <div class="defense-box">
                                <span class="value">{{ derived defense.value }}</span>
                            </div>
                        </div>
                    {{/with}}

                    {{#with attrGroup.attributes.[1] as |attribute|}}
                        <div class="attribute flexcol" data-id="{{attribute.id}}">
                            <span class="box-title">
                                {{ localize attribute.config.label }}
                            </span>
                            <span class="value">
                                <input 
                                    class="value" 
                                    size="2" 
                                    name="system.attributes.{{attribute.config.key}}.value" 
                                    value="{{attribute.value}}" 
                                />
                            </span>
                        </div>
                    {{/with}}
                </section>
            </section>
        {{/each}}
    </section>


    <section class="sheet-body">
        
        <div class="skills flexcol" data-group="primary" data-tab="skills">
            <section class="attribute-groups flexrow">
                {{#each attributeGroups as |attrGroup|}}
                    {{!-- Resource --}}
                    <section class="attribute-groups flexcol">
                   
                        {{!-- Skills --}}
                        <section class="skills flexcol">
                            {{#with attrGroup.resource as |resource|}}
                                <div class="resource flexrow" data-id="{{resource.id}}">
                                    <div class="flexcol">
                                        <span class="label">{{ localize resource.config.label}}</span>
                                        <span class="value">{{resource.value}} / {{resource.max.value}}</span>
                                    </div>
                                    {{#if resource.deflect includeZero=true}}
                                        <div class="deflect flexcol">
                                            <span class="label">{{ localize "COSMERE.Actor.Statistics.Deflect"}}</span>
                                            <span class="value">{{ resource.deflect.value }}</span>
                                        </div>
                                    {{/if}}
                                </div>
                            {{/with}} 
                            <ul class="skill-list">
                                {{#each attrGroup.skills as |skill|}}
                                    {{#if skill.active}}
                                        <li class="skill" data-id="{{skill.id}}">
                                            <div class="mod-box rollable">
                                                <span class="mod">+{{derived skill.mod }}</span>
                                            </div>

                                            <div class="label rollable">
                                                <span>{{ localize skill.config.label }}</span>
                                                <span style="text-transform: uppercase">({{ localize skill.config.attrLabel }})</span>
                                            </div>
                                            <div class="skill-pips ranks">
                                                <ul class="pip-skills">
                                                    <a data-action="adjust-skill-rank" data-id="{{skill.id}}" data-tooltip="Left Click to increase {{localize skill.config.label}}'s Rank<br>Right Click to decrease {{localize skill.config.label}}'s Rank">
                                                        {{#times skill.rank}}<li class="fa-solid fa-dot-circle"></li>{{/times}}
                                                        {{#times (sub 5 skill.rank)}}<li class="fa-regular fa-circle"></li>{{/times}}
                                                    </a>
                                                </ul>
                                            </div>
                                        </li>

                                    {{/if}}
                                {{/each}}
                            </ul>
                        </section>
                    </section>
                {{/each}}
                <!--{{#each attributeGroups as |attrGroup|}}
                {{/each}}-->
            </section>
        </div>

        <div class="tab biography flexrow" data-group="primary" data-tab="biography"></div>
    </section>
</form>